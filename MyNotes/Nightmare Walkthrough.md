# HacktheBox Machine: Nightmare 
**Penetration Methodology**
  * [Network scanning ](#network-scanning)
  * [Browsing IP address through HTTP](#browsing-ip-address-through-http)
  * [Checking for SQL injection vulnerability](#checking-for-sql-injection-vulnerability)
  * [Exploiting Second-Order Injection](#exploiting-second-order-injection)
  * [Login through SSH](#login-through-ssh)
  * [Login through SFTP](#login-through-sftp)
  * [Exploiting SFTP to gain a reverse shell](#exploiting-sftp-to-gain-a-reverse-shell)
  * [Discovering files with SGID bit set](#discovering-files-with-sgid-bit-set)
  * [Privileges escalation using “sls”](#privileges-escalation-using-sls)
  * [Finding exploit for kernel](#finding-exploit-for-kernel)
  * [Making changes to the exploit](#making-changes-to-the-exploit)
  * [Getting root privilege using the exploit](#getting-roo)
  * [Getting the root flag](#getting-the-root-flag)
  
 
 ## Network Scanning
  * nmap -sC -sV 10.10.10.66 revealed ports http/80 and ssh/2222 are open.

## Browsing IP address through HTTP
  * Login page available, however, no php pages were visible in the URL
  
## Checking for SQL Injection vulnerability
  * The page is vulnerable to [Second Order SQL Injection](https://medium.com/@fiddlycookie/the-wrath-of-second-order-sql-injection-c9338a51c6d).
  * Meaning, to exploit this vulnerability we have to register a user with
    the SQL injection and then login with the same username.
  * Register a user with the credentials: 
  *  * **"admin'): pass"**
  * Find number of columns in database by registering another user: 
  *  * **"admin')order by 2#"**
  * No SQL error messages, meaning the table has 2 columns,
  * Find the version of SQL DB. Register another user: 
     * **"admin') UNION SELECT 1,@@version#"**
  * MySQL DB confirmed. Now find the name of the database:
     * **"admin') UNION SELECT 1,database()#"**
